이미 내장앱이 작성이 되어있음 -> 장고의 인증 시스템에서 반응

auth 인증 프레임워크의 핵심 기본 모델 포함 

contenttypes 권한에 관련된 것



인증과 권한이 결합되어 있는데 인증시스템이라고 함



인증 신원 확인

권한 권한 부여 인증된 사용자가 수행할 수 있는 작업을 결정



두번째 앱 생성

app 이름이 반드시 acoutns 일 필요는 없음

django 내부적으로 accounts라는 이름으로 사용되고 있기 때문에 accounts로 지정하는것을 권장



accounts 앱 생성했으면 앱 등록  생성 후 등록!!

url에 가서 해줌 이 문자열이 들어온다면~~

어차피 articles랑 구조는 똑같을거니까~

accounts 앱의 urls.py 만들어줌



쿠키와 세션

HTTP 

Protocol 규칙 규약

비연결지향 서버는 요청에 대한 응답을 보낸 후 클라이언트랑 연결을 끊음

네이버에 들어갔어 우리랑 네이버가 연결이 되어있구나!하고 생각을 할 수 있어

연결이 되어있으니까 이 페이지를 볼 수 있구나~ 사실 이건 불가능해

즉 우리가 네이버의 메인 페이지를 줘ㅓ하고 요청을 보내면 네이버의 메인 페이지를 보내는 응답을 하고 끊어지는거 서로 손을 잡고 있는게 아니야

무상태 연결을 끊는 순간 서로의 통신이 끝나기 때문에 이 상태가 유지되지 않음

서로 완전히 독립적임

근데 로그인 상태는 유지 됨

  클라이언트와 서버의 지속적인 관계를 유지하기 위해 쿠키와 세션이 필요함!



쿠키

서버가 주는 작은 데이터 조각 

우리가 웹사이트를 방문할 때 웹 브라우저가 우리에게 주는 것

사용자의 컴퓨터에 설치되는 작은 기록 정보 파일

KEY-VALUE 데이터 형식으로 저장

동일한 서버에 재 요청시 저장된 쿠키를 함께 전송함



로그인 요청이 담긴 쿠키와 응답을 같이 보내주고 클라이언트의 컴퓨터에 쿠키가 저장이 되고 같은걸 재요청할 때 요청과 쿠키를 같이 보냄

나 지금 로그인 되었어 하고 매요청마다 말해줌 나 로그인 되어있는 사람이야~ 그래서 마치 상태가 계속해서 유지되어 있는 것 처럼 보임 서버는 매 요청을 받을때마다 어? 얘 연결되어 있는 사람이네 하고 인식



쿠키 사용 목적

세션관리

상태를 유지시켜주는 세션 로그인, 아이디 자동완성, 공지 하루 안보기, 팝업 체크, 장바구니

개인화

트래킹 시크릿모드 모든 요청에 대해 데이터를 저장하지 않고 일회용으로 사용하는! 



개발자 도구 - 네트워크 - 헤더

set-cookie 

cookies

request cookies 요청할 때 보내는 쿠키

response cookies 응답을 받는 쿠키



장바구니에서 상품 삭제 버튼은 내가 도마를 가지고 있다는 쿠키를 삭제하는거

cookies clear 누르면 도마가 사라짐



세션 

무상태를 상태가 있는 것처럼 유지시키는 것

클라이언트가 서버에 접속하면 서버가 특정 session id를 발급하고 클라이언트는 발급 받은 session id를 쿠키에 저장 쿠키는 요청 때마다 서버에 함께 전송되고 서버에서 session id를 확인해 알맞은 로직을 처리

쿠키에는 ID만 저장함 key만 저장하는거! 값은 서버가 저장하고 있음



응? 유효기간이 작성되어 있지 않은 세션들은?

쿠키는 수명주기에 따라 두가지로 정의됨

Session cookies 브라우저가 현재 세션이 종료되는 시기를 정의

현재 세션이 종료되면 같이 삭제됨

ex.swea 

Persistent cookies

지정된 기간이 지나면 삭제



장고는 짱이야..



로그인은 session을 create하는 로직과 같음



Authentication Form

urls.py

views.py

로그인을 하기 위해서는 원래대로라면 view 함수가 

로그인 페이지 GET 

로그인 진행 POST

우리는 지금까지 ModelForm을 만들었는데 이제 built-in forms을 사용할거야



ArticleForm ModelForm을 상속받음 

키워드 인자의 구조는 결국 부모를 따라감

AuthenticationForm은 다름 이건 ModelForm이 아니구나..라고 추정 가능해

-> Form의 상속을 받음

user name password DB에 저장 되는거? ㄴㄴ

그렇기때문에 ModelForm을 쓸 필요가 없음

이 두개를 받아서 세션을 create 하는 것

AuthenticationForm이 실제 session을 만들어주는건 아님

login 함수가 필요함



로그아웃

session 을 Deletd하는 로직과 같음

logout 함수가 따로 있음

인자를 request 하나만 받고 반한 값도 없음

사용자가 로그인하지 않은 경우 오류를 발생시키지 않음

session data를 DB에서 완전히 삭제, 쿠키에서도 sessionid 삭제

클라이언트에 남아있으면 누군가 엑세스할 수 있으니까 이걸 방지하기 위해서 



request.user.is~

request가 들어오면 middleware를 쭉 통과하고 우리가 적어둔 url view를 통과하고(우리의 함수를 통과) 다시 response로 올라 가면서 함수, middleware를 통과함





쿠키 데이터의 조각

세션 만료 유통기한 상태

쿠키와 세션의 차이

쿠키안쪽에 세션 아이디가 있음

쿠키는 서버의 자원을 사용(우리 컴퓨터에 저장) 엥??

세션은 서버의 자원을 사용하지 않음(서버에 저장) ?잉?

이걸 왜 만든거야? 어떠한 상태를 유지하고 싶어서

HTTP 상태를 저장할 수 없음 쿠키와 세션을 이용

채팅 서비스는 websocket을 이용

쿠키는 항상 내 컴퓨터에 저장되어 있고 key-value 형태



